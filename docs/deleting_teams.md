# Deleting teams in Console

Deleting teams in Console is a complex operation, and requires a more thorough explanation.

A team will be soft-deleted in the database. This means that the team entry will be kept in the database, but will be 
marked as deleted, as opposed to being completely removed from the `teams` table. As a result of this, team slugs 
**cannot** be reused.

## How to perform a team deletion

Deleting a team from Console can not be done by a single individual. The process requires two separate team owners that 
have to perform the following operations:

1) Owner A creates a team deletion request by using the Console UI. This operation generates a URL that must be shared
with owner B.
2) Owner B visits the URL generated by owner A, and confirms the delete request.

Once a delete request is confirmed it **cannot** be aborted.

Since a team has many external resources (GitHub team, GCP project, CDN bucket, ...) the deletion process is 
asynchronous. If the process completes successfully, the team will be marked as "permanently deleted" in the database,
and **will no longer** be accessible through the GraphQL API. 

If, on the other hand, the deletion process fails, the team will **not** be marked as "permanently deleted", and errors 
during the deletion process can be fetched from the GraphQL API for further investigation and possible manual cleanup.

The actual deletion of external resources is handled by [api-reconcilers](https://github.com/nais/api-reconcilers) (
which is also responsible for creating the external resources when the team was initially created).

The deletion process is triggered via a message queue.

## Reusing a team slug

As mentioned above, team slugs **cannot** be reused. This is by design, and prevents accidental takeover of potential 
external resources that the previous version of the team had access to.

## Restoring deleted teams

Restoring a deleted team is **not** supported. This is by design, and is related to the fact that a team
in Console has many external resources that might not be restorable using the same team slug (since the team slug is in
almost all cases used when creating external resources).
