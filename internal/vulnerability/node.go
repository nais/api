package vulnerability

import (
	"fmt"

	"github.com/nais/api/internal/graph/ident"
)

type identType int

const (
	identVulnerability identType = iota
)

func init() {
	ident.RegisterIdentType(identVulnerability, "VUL", getVulnerabilityByIdent)
}

func newVulnerabilityIdent(projectID, identifier, componentID string) ident.Ident {
	return ident.NewIdent(identVulnerability, projectID, identifier, componentID)
}

func parseVulnerabilityIdent(id ident.Ident) (projectID, vulnerabilityID, componentID string, err error) {
	parts := id.Parts()
	if len(parts) != 3 {
		return "", "", "", fmt.Errorf("invalid vulnerability ident")
	}

	return parts[0], parts[1], parts[2], nil
}
