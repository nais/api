package vulnerability

import (
	"context"
	"github.com/nais/api/internal/database/gensql"
	logrustest "github.com/sirupsen/logrus/hooks/test"
	"github.com/stretchr/testify/mock"
	"testing"
)

func TestUpdater_UpdateVulnerabilityMetrics(t *testing.T) {
	log, _ := logrustest.NewNullLogger()
	// dpMock := dependencytrack.NewMockInternalClient(t)
	querier := gensql.NewMockQuerier(t)

	querier.EXPECT().GetActiveTeams(mock.Anything).Return(
		[]*gensql.Team{
			{
				Slug: "team1",
			},
		}, nil)

	updater := NewMetricUpdater(nil, nil, querier, log)
	_, err := updater.UpdateVulnerabilityMetrics(context.Background())
	if err != nil {
		t.Errorf("expected no error, got %v", err)
	}
}
